NAME = miniRT

INC_DIR = ./includes
SRC_DIR  = ./srcs

PARSING = parsing/

EXEC = exec/

BUILD_DIR  = ./objs

LIBFT_DIR = ./libft
LIBFT_INC_DIR = ./libft/includes
LIBFT = ./libft/libft.a
LIB_MLX	= ./minilibx

S_EXT = .c

SRCS = ${addsuffix ${S_EXT}, ${addprefix ${SRC_DIR}/, \
		mlx_window}}
#		main \
#		error \
#		parse \
#		}}

DEPS = ${subst ${SRC_DIR}, ${BUILD_DIR}, ${SRCS:%.c=%.d}}
OBJS = ${subst ${SRC_DIR}, ${BUILD_DIR}, ${SRCS:%.c=%.o}}
VPATH = ${SRC_DIR}:${INC_DIR}:${BUILD_DIR}

CC = clang
CFLAGS = -Wall -Wextra -Werror -g3
INCLUDES = -I ${INC_DIR} -I ${LIBFT_INC_DIR} -I ${LIB_MLX}
LD_FLAGS = -L ${LIBFT_DIR} -L ${LIB_MLX} -lmlx_Linux -lXext -lX11
COMP = ${CC} ${CFLAGS}
RM	 = rm -rf

all: libftcreat ${NAME}

libftcreat:
	@make -sC ${LIBFT_DIR}

${NAME}: ${OBJS} ${LIBFT}
	@${COMP} ${LD_FLAGS} ${OBJS} -o ${NAME}
	@echo "${NAME} created"

-include ${DEPS}

${BUILD_DIR}/%.o: %.c
	@mkdir -p ${dir $@}
	@echo create: ${@:%=%}
	@${COMP} -MMD ${INCLUDES} -c $< -o $@

clean:
	@make clean -C libft
	@${RM} ${BUILD_DIR}
	@${RM} ${DEPS}
	@echo "objs deleted"

fclean: clean
	@make fclean -C libft
	@${RM} ${NAME}
	@echo "program deleted"

gitm:
	git add .
	git commit
	git push

re: fclean all

.PHONY: all clean fclean re libftcreat
